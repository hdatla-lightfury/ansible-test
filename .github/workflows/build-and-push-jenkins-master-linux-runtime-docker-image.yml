name: Build and Push Jenkins Docker Images to ECR

on:
  push:
    branches:
      - main
      - staging
    paths:
      - 'images/docker/jenkins/master/linux-runtime/**'
jobs:
  build-master-linux-runtime:
    uses: ./.github/workflows/reusable-build-and-push-docker-images.yml
    with:
      dockerfile_dir: images/docker/jenkins/master/linux-runtime
      image_config_file: images/docker/jenkins/master/linux-runtime/image-config.yml
      ansible_playbook_dir: configuration/ansible/playbooks/docker/jenkins/
      ansible_playbook_file_name: build-push-docker-images.yml
      ecr_repo: jenkins/master
      env_file_contents: |
        CASC_JENKINS_CONFIG=/var/jenkins_home/jenkins-casc.yaml
        SLACK_TOKEN=${{ secrets.SLACK_TOKEN }}
        JENKINS_ADMIN_PASSWORD=${{ secrets.JENKINS_ADMIN_PASSWORD }}
        PERFORCE_TRIGGER_API_TOKEN=${{ secrets.PERFORCE_TRIGGER_API_TOKEN }}
        AUTHSPHERE_TOKEN=${{ secrets.AUTHSPHERE_TOKEN }}
        SWARM_AGENT_TOKEN=${{ secrets.SWARM_AGENT_TOKEN }}
        PERFORCE_USERNAME=${{ secrets.PERFORCE_USERNAME }}
        PERFORCE_PASSWORD=${{ secrets.PERFORCE_PASSWORD }}
        PERFORCE_PORT=${{ secrets.PERFORCE_PORT }}
        GOOGLE_CLIENT_ID=${{ secrets.GOOGLE_CLIENT_ID }}
        GOOGLE_CLIENT_SECRET=${{ secrets.GOOGLE_CLIENT_SECRET }}
        JENKINS_ADMIN_GOOGLE_APP_PASSWORD=${{ secrets.JENKINS_ADMIN_GOOGLE_APP_PASSWORD }}
      secrets: inherit
          
          